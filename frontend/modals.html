<!-- Account Modal -->
<div class="modal fade" id="accountModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="accountModalTitle">Agregar Cuenta</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="accountForm">
                    <div class="mb-3">
                        <label for="accountName" class="form-label">Nombre de la cuenta</label>
                        <input type="text" class="form-control" id="accountName" required>
                    </div>
                    <div class="mb-3">
                        <label for="accountType" class="form-label">Tipo de cuenta</label>
                        <select class="form-select" id="accountType" required>
                            <option value="">Seleccionar tipo</option>
                            <option value="checking">Cuenta Corriente</option>
                            <option value="savings">Cuenta de Ahorros</option>
                            <option value="investment">Inversión</option>
                            <option value="cash">Efectivo</option>
                            <option value="credit">Tarjeta de Crédito</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="accountBank" class="form-label">Banco</label>
                        <input type="text" class="form-control" id="accountBank">
                    </div>
                    <div class="mb-3">
                        <label for="accountNumber" class="form-label">Número de cuenta</label>
                        <input type="text" class="form-control" id="accountNumber">
                    </div>
                    <div class="mb-3">
                        <label for="accountBalance" class="form-label">Saldo inicial</label>
                        <input type="number" class="form-control" id="accountBalance" step="0.01" value="0">
                    </div>
                    <div class="mb-3">
                        <label for="accountCurrency" class="form-label">Moneda</label>
                        <select class="form-select" id="accountCurrency" required>
                            <option value="COP">Peso Colombiano (COP)</option>
                            <option value="USD">Dólar Americano (USD)</option>
                            <option value="EUR">Euro (EUR)</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" onclick="saveAccount()">Guardar</button>
            </div>
        </div>
    </div>
</div>

<!-- Income Modal -->
<div class="modal fade" id="incomeModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="incomeModalTitle">Agregar Ingreso</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="incomeForm">
                    <div class="mb-3">
                        <label for="incomeDescription" class="form-label">Descripción</label>
                        <input type="text" class="form-control" id="incomeDescription" required>
                    </div>
                    <div class="mb-3">
                        <label for="incomeAmount" class="form-label">Monto</label>
                        <input type="number" class="form-control" id="incomeAmount" step="0.01" required>
                    </div>
                    <div class="mb-3">
                        <label for="incomeCategory" class="form-label">Categoría</label>
                        <select class="form-select" id="incomeCategory" required>
                            <option value="">Seleccionar categoría</option>
                            <option value="salario">Salario</option>
                            <option value="freelance">Freelance</option>
                            <option value="inversion">Inversión</option>
                            <option value="negocio">Negocio</option>
                            <option value="pension">Pensión</option>
                            <option value="subsidio">Subsidio</option>
                            <option value="bonificacion">Bonificación</option>
                            <option value="comision">Comisión</option>
                            <option value="alquiler">Alquiler</option>
                            <option value="venta">Venta</option>
                            <option value="otro">Otro</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="incomeDate" class="form-label">Fecha</label>
                        <input type="date" class="form-control" id="incomeDate" required>
                    </div>
                    <div class="mb-3">
                        <label for="incomeAccount" class="form-label">Cuenta</label>
                        <select class="form-select" id="incomeAccount" required>
                            <option value="">Seleccionar cuenta</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="incomeCurrency" class="form-label">Moneda</label>
                        <select class="form-select" id="incomeCurrency" required>
                            <option value="COP">Peso Colombiano (COP)</option>
                            <option value="USD">Dólar Americano (USD)</option>
                            <option value="EUR">Euro (EUR)</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="incomeRecurring">
                            <label class="form-check-label" for="incomeRecurring">
                                Ingreso recurrente
                            </label>
                        </div>
                    </div>
                    <div class="mb-3" id="recurringPatternDiv" style="display: none;">
                        <label for="incomeRecurringPattern" class="form-label">Patrón de recurrencia</label>
                        <select class="form-select" id="incomeRecurringPattern">
                            <option value="monthly">Mensual</option>
                            <option value="weekly">Semanal</option>
                            <option value="yearly">Anual</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-success" onclick="saveIncome()">Guardar</button>
            </div>
        </div>
    </div>
</div>

<!-- Expense Modal -->
<div class="modal fade" id="expenseModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="expenseModalTitle">Agregar Gasto</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="expenseForm">
                    <div class="mb-3">
                        <label for="expenseDescription" class="form-label">Descripción</label>
                        <input type="text" class="form-control" id="expenseDescription" required>
                    </div>
                    <div class="mb-3">
                        <label for="expenseAmount" class="form-label">Monto</label>
                        <input type="number" class="form-control" id="expenseAmount" step="0.01" required>
                    </div>
                    <div class="mb-3">
                        <label for="expenseBudget" class="form-label">Presupuesto</label>
                        <select class="form-select" id="expenseBudget" onchange="updateExpenseCategories()" required>
                            <option value="">Seleccionar presupuesto</option>
                            <option value="unbudgeted">⚠️ Sin presupuesto (No recomendado)</option>
                        </select>
                        <div class="form-text">Se recomienda asociar todo gasto a un presupuesto</div>
                        <div id="budgetWarning" class="alert alert-warning mt-2" style="display: none;">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <strong>Advertencia:</strong> Los gastos sin presupuesto pueden descontrolar tus finanzas. 
                            ¿Estás seguro de continuar?
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="expenseCategory" class="form-label">Categoría</label>
                        <select class="form-select" id="expenseCategory" required>
                            <option value="">Primero selecciona un presupuesto</option>
                        </select>
                        <div class="form-text">Las categorías se actualizan según el presupuesto seleccionado</div>
                    </div>
                    <div class="mb-3">
                        <label for="expenseDate" class="form-label">Fecha</label>
                        <input type="date" class="form-control" id="expenseDate" required>
                    </div>
                    <div class="mb-3">
                        <label for="expenseAccount" class="form-label">Cuenta</label>
                        <select class="form-select" id="expenseAccount" required>
                            <option value="">Seleccionar cuenta</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="expenseCurrency" class="form-label">Moneda</label>
                        <select class="form-select" id="expenseCurrency" required>
                            <option value="COP">Peso Colombiano (COP)</option>
                            <option value="USD">Dólar Americano (USD)</option>
                            <option value="EUR">Euro (EUR)</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-danger" onclick="saveExpense()">Guardar</button>
            </div>
        </div>
    </div>
</div>

<!-- Budget Modal -->
<div class="modal fade" id="budgetModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="budgetModalTitle">Agregar Presupuesto</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="budgetForm">
                    <div class="mb-3">
                        <label for="budgetName" class="form-label">Nombre del presupuesto</label>
                        <input type="text" class="form-control" id="budgetName" required>
                    </div>
                    <div class="mb-3">
                        <label for="budgetType" class="form-label">Tipo de Presupuesto</label>
                        <select class="form-select" id="budgetType" required onchange="toggleBudgetInputs()">
                            <option value="">Seleccionar tipo</option>
                            <option value="fixed">Monto Fijo</option>
                            <option value="percentage">Porcentual</option>
                        </select>
                    </div>
                    <div class="mb-3" id="amountInput">
                        <label for="budgetAmount" class="form-label">Monto</label>
                        <input type="number" class="form-control" id="budgetAmount" step="0.01">
                    </div>
                    <div class="mb-3" id="percentageInput" style="display: none;">
                        <label for="budgetPercentage" class="form-label">Porcentaje de Ingresos</label>
                        <div class="input-group">
                            <input type="number" class="form-control" id="budgetPercentage" min="1" max="100" step="0.1">
                            <span class="input-group-text">%</span>
                        </div>
                        <div class="form-text">El presupuesto se calculará automáticamente basándose en los ingresos del período</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Categorías del Presupuesto</label>
                        <div id="budgetCategoriesContainer">
                            <div class="category-item mb-2">
                                <div class="input-group">
                                    <input type="text" class="form-control budget-category-input" placeholder="ej: Servicios, Materiales, Supermercado" required>
                                    <button type="button" class="btn btn-outline-danger" onclick="removeCategory(this)" style="display: none;">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="btn btn-outline-primary btn-sm" onclick="addCategory()">
                            <i class="fas fa-plus me-1"></i>Agregar Categoría
                        </button>
                        <div class="form-text">Define las categorías específicas para este presupuesto</div>
                    </div>
                    <div class="mb-3">
                        <label for="budgetPeriod" class="form-label">Período</label>
                        <select class="form-select" id="budgetPeriod" required onchange="updateBudgetPeriodDates()">
                            <option value="">Seleccionar período</option>
                            <option value="monthly">Mensual</option>
                            <option value="quarterly">Trimestral</option>
                            <option value="semiannual">Semestral</option>
                            <option value="annual">Anual</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="budgetPeriodStart" class="form-label">Fecha de inicio</label>
                        <input type="date" class="form-control" id="budgetPeriodStart" required>
                    </div>
                    <div class="mb-3">
                        <label for="budgetPeriodEnd" class="form-label">Fecha de fin</label>
                        <input type="date" class="form-control" id="budgetPeriodEnd" required>
                    </div>
                    <div class="mb-3">
                        <label for="budgetCurrency" class="form-label">Moneda</label>
                        <select class="form-select" id="budgetCurrency" required>
                            <option value="COP">Peso Colombiano (COP)</option>
                            <option value="USD">Dólar Americano (USD)</option>
                            <option value="EUR">Euro (EUR)</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-warning" onclick="saveBudget()">Guardar</button>
            </div>
        </div>
    </div>
</div>
